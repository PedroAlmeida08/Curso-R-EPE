---
title: "R para Análise de Dados"
author: "Bruno Crotman"
date: "17/08/2019"
output: 
    slidy_presentation:
        toc: true
        toc_depth: 3

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# INTRODUÇÃO


## Objetivos do curso

Meta final: que vários dos processos de análise de dados da empresa passem a ser feitos dentro do fluxo de trabalho do R.

![](imagens/tidyverse.png)

Ao fim do curso o objetivo é que todos os fios da meada sejam puxados para que o aluno consiga continuar por si só usando a vasta documentação disponível.

## Por que programar?


Também amo o Excel, mas amo mais as seguintes vantagens:

* **Reprodutibilidade**. Muito mais fácil refazer uma análise com código do que point and click

* **Menor risco operacional**. A automatização é maior, a chance de erro na execução de um passo manual é nula

* **Menor risco de continuidade** caso haja imprevistos com a equipe. 

* **Maior flexibilidade**. Virtualmente tudo é possível

* **Manutenção** mais fácil

* **Controle de versão** de forma profissional

* **Mais fácil do que parece**


## Por que programar em R?

* Ela é feita para lidar com dados

* Comunidade de usuários gigante e cooperativa

* Prazeroso programar


## Fluxo de trabalho

![](imagens/tidyverse_simplificado.png){width=50%} 


![](imagens/tidyverse.png){width=50%}


## Ambiente R/RStudio

R é uma linguagem que é interpretada por um [engine](https://cran.r-project.org/) gratuito.

[RStudio](https://www.rstudio.com/) é o melhor ambiente de programação da linguagem R. A versão mais simples, que é totalmente funcional, é gratuita.

![](imagens/RStudio.png){width=50%}

A princípio ele oferece um console para execução de comandos e a visualização do *environment*, ou seja, as variáveis que ele guarda na sessão atual.


## Baixando o material do github

Todo o material do curso está hospedado no Github, inclusive esta apresentação, escrita em RMarkdown.

Os exemplos de código, as imagens e os dados mostrados nesta apresentação estão inclusos no repositório do curso.

O repositório fica em [github/crotman/cursoR](https://github.com/crotman/CursoR).

Para baixar este repositório no RStudio, crie um projeto em File/New Project, do tipo Github e use o endereço do repositório: https://github.com/crotman/CursoR.git.


# FUNDAMENTOS DA LINGUAGEM
    
## RStudio como console

No console é possível executar comandos, como o que atribui valor a uma variável

```{r,  echo=TRUE}

x <- 1

```

Note que a atribuição é feita com `<-` e não com `=` como na maioria das linguagens.

>Dica: o atalho **alt** + **-** gera o sinal de atribuição

Os comandos que não atribuem valor a uma variável são ecoados na tela

```{r,  echo=TRUE}

x + 2

```

Veja o `[1]` no console. O R considera que tudo é um vetor. É uma linguagem muito baseada em operações vetoriais. Isso facilita muito as coisas quando se lida com dados.


## A função c()

A função mais usada do R provavelmente é a c(), que cria um vetor. De várias formas.

```{r, echo=TRUE}

c(1, 2, 3)

c(1, 2, 3, c(4, 5, 6))

1.4 : 9.4

```

## Outras formas de gerar um vetor

O operador `:` é usado para gerar um vetor com todos números que estão entre os operandos e são formados somando números inteiros ao primeiro operando.

```{r echo=TRUE}

1:10

1.5:9.1

```

A função `seq()` é usada para criar um vetor de várias formas. 

Numa das formas especifica-se o valor inicial, o valor final e o incremento entre elementos do vetor. 


```{r echo=TRUE}

seq(1, 9.99, 0.1)


```

## Parâmetros nomeados


Note que chamamos a função passando os parâmetros sem especificação de quais são eles. Eles são recebidos pela função dem específica. 

Mas no R também é possível passar parâmetros de forma nomeada. 

Clique em `F1` enquanto tem o cursor em cima da função e veja a ordem dos parâmetros. Veja que outros parâmetros que não utilizamos. Podemos usar `length.out` ao invés de `by`:

```{r echo=TRUE}


seq(1, 10, length.out = 10)

seq(1, 10, length.out = 5)

```

Outro parâmetro, `along.with`, deixa que criemos um vetor num intervalo determinado e o mesmo número de elementos do vetor passado por este parâmetro. 

```{r echo=TRUE}

seq(20, 100, along.with = 1:10)

```

## Programação com vetores

As operações do R são vetoriais. Numa operação entre um vetor e um escalar, a operação com o escalar é aplicada a cada elemento do vetor


```{r echo=TRUE}

1:5 * 2

```


```{r echo=TRUE}

1:10 / 10

```


Numa operação com vetores do mesmo tamanho, os elementos são pareados


```{r echo=TRUE}

1:10 * 1:10

```

## Programação com vetores - recycling

Outro conceito importante é o de *recycling*. 

Numa operação entre dois vetores de tamanhos diferentes, o vetor menor é repetido ciclicamente de forma a ficar com o mesmo tamanho do vetor maior. 

Lembra que toda variável no R é um vetor? 

Então... o escalar mostrado no primeiro código do slide anterior é um vetor de 1 elemento que sofre *recycling*


```{r echo=TRUE}

1:10 * 1:2

```


## Dataframes

Dataframes são uma estrutra muito usada em análises de dados feitas em R.

O dataframe consiste em um conjunto de vetores nomeados, com o mesmo número de elementos, que formam uma estrutura retangular, onde cada coluna é um dos vetor e cada linha n contém o n-ésimo elemento dos vetores.


```{r echo=TRUE}

df <- 
    data.frame(
    nome = c("João", "Maria", "Zezinho", "Juquinha"), 
    idade = c(7, 8, 9, 10), 
    altura = c(10, 11)
    )

df

```




## Loops: cuidado!


## Exemplo inicial de visualização de dados

```{r, eval=TRUE, code = readLines("exemplos\\exemplo_inicial_ggplot.r")}



```


# TIDY DATA 

## Organizando os dados de forma tidy

![](imagens/tidydata.png)
## Tratamento de dados em passos: operador Pipe

## Funções básicas de tratamento (dplyr)

## Leitura de dados

-read_csv

-read_fwf

-read_excel


## Funções de junção (dplyr)

## Funções de pivot (tidyr)

## Tratamento de strings (caracteres) com stringr

## Tratamento de datas (lubridate)

## Tratamento de dados categóricos (forcats) 

# VISUALIZAÇÃO DE DADOS 

# PROGRAMAÇÃO FUNCIONAL 

## Aplicação de funções a dataframes (purrr)

## map-reduce

# EXECUTANDO MODELOS

## Execução de modelos com broom

## Execução de modelos com caret

# SÉRIES TEMPORAIS

## Repositórios de séries temporais

## Manipulação de séries temporais

## Biblioteca Forecast

# COMUNICANDO OS RESULTADOS

## Criando relatórios com R Markdown

## Criando visualizações interativas com Shiny









